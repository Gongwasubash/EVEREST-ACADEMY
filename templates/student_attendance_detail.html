{% extends 'base.html' %}

{% block title %}{{ student.name }} - Attendance Details{% endblock %}

{% block content %}
<div class="container" style="max-width: 1200px; margin: 0 auto; padding: 2rem;">
  <div class="header" style="background: white; border-radius: 20px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: flex; gap: 2rem; align-items: center;">
    <div class="student-photo" style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, #60a5fa, #a78bfa); display: flex; align-items: center; justify-content: center; color: white; font-size: 3rem; font-weight: 700; overflow: hidden;">
      {% if student.photo %}
        <img src="{{ student.photo.url }}" alt="{{ student.name }}" style="width: 100%; height: 100%; object-fit: cover;">
      {% else %}
        {{ student.name|first }}
      {% endif %}
    </div>
    <div>
      <h1 style="color: #1e293b; margin: 0;">📊 {{ student.name }}</h1>
      <p style="color: #64748b; margin: 0.5rem 0;">Class: {{ student.student_class }}-{{ student.section }} | Roll: {{ student.reg_number }}</p>
      <p style="color: #64748b; margin: 0;">Father: {{ student.father_name }} | Mobile: {{ student.father_mobile }}</p>
    </div>
  </div>

  <div class="stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="stat" style="background: white; border-radius: 15px; padding: 1.5rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
      <div style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;">✅</div>
      <div style="font-size: 2rem; font-weight: 800; margin: 0;">{{ present_count }}</div>
      <div style="color: #64748b; font-size: 0.9rem;">Present</div>
    </div>
    <div class="stat" style="background: white; border-radius: 15px; padding: 1.5rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
      <div style="font-size: 2rem; color: #ef4444; margin-bottom: 0.5rem;">❌</div>
      <div style="font-size: 2rem; font-weight: 800; margin: 0;">{{ absent_count }}</div>
      <div style="color: #64748b; font-size: 0.9rem;">Absent</div>
    </div>
    <div class="stat" style="background: white; border-radius: 15px; padding: 1.5rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
      <div style="font-size: 2rem; color: #f59e0b; margin-bottom: 0.5rem;">⏰</div>
      <div style="font-size: 2rem; font-weight: 800; margin: 0;">{{ late_count }}</div>
      <div style="color: #64748b; font-size: 0.9rem;">Late</div>
    </div>
    <div class="stat" style="background: white; border-radius: 15px; padding: 1.5rem; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
      <div style="font-size: 2rem; color: #60a5fa; margin-bottom: 0.5rem;">📊</div>
      <div style="font-size: 2rem; font-weight: 800; margin: 0;">{{ attendance_percentage }}%</div>
      <div style="color: #64748b; font-size: 0.9rem;">Attendance</div>
    </div>
  </div>

  <div class="chart-container" style="background: white; border-radius: 20px; padding: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
    <h3 style="margin: 0 0 2rem 0; color: #1e293b;">Attendance Chart</h3>
    <canvas id="attendanceChart" width="400" height="200"></canvas>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('attendanceChart').getContext('2d');
const attendanceChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        labels: ['Present', 'Absent', 'Late'],
        datasets: [{
            data: [{{ present_count }}, {{ absent_count }}, {{ late_count }}],
            backgroundColor: ['#10b981', '#ef4444', '#f59e0b'],
            borderWidth: 0
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    padding: 20,
                    font: {
                        size: 14
                    }
                }
            }
        }
    }
});
</script>
{% endblock %}